<?xml version="1.0" encoding="utf-8"?>
<!--
  ASP.NET uygulamanızı nasıl yapılandıracağınız hakkında daha fazla bilgi için lütfen şu adresi ziyaret edin:
   https://go.microsoft.com/fwlink/?LinkId=169433
  -->
<configuration>
  
  <!-- 
    GÜVENLİK UYARISI: 
    Bu dosyadaki hassas bilgiler (parola, connection string) sadece ÖRNEK'tir.
    Production ortamında:
    1. Ortam değişkenleri kullanın (örn: TICKETX_CONNECTION_STRING)
    2. Azure Key Vault, AWS Secrets Manager gibi secret yönetim servisleri kullanın
    3. Web.config'i git'e commit ETMEYİN (eğer gerçek değerler içeriyorsa)
  -->
  
  <connectionStrings>
    <!-- 
      SQL Server bağlantı string'i
      Production'da bu değeri ortam değişkenine taşıyın: TICKETX_CONNECTION_STRING
      Örnek ortam değişkeni:
      TICKETX_CONNECTION_STRING=Data Source=YOUR_SERVER;Initial Catalog=ticket;User ID=YOUR_USER;Password=YOUR_PASSWORD;
    -->
    <add name="TicketXDb" 
         connectionString="Data Source=localhost\SQLEXPRESS;Initial Catalog=ticket;Integrated Security=True;" 
         providerName="System.Data.SqlClient" />
  </connectionStrings>

  <appSettings>
    <!-- SMTP Ayarları -->
    <!-- Production'da ortam değişkenleri kullanın: TICKETX_SMTPHOST, TICKETX_SMTPUSERNAME, vb. -->
    <add key="SmtpHost" value="smtp.gmail.com" />
    <add key="SmtpPort" value="587" />
    <add key="SmtpUsername" value="your-email@gmail.com" />
    <add key="SmtpPassword" value="YOUR_APP_PASSWORD_HERE" />
    <add key="SmtpSenderEmail" value="your-email@gmail.com" />
    <add key="SmtpSenderName" value="TicketX" />
    <add key="SmtpEnableSsl" value="true" />

    <!-- Güvenlik Ayarları -->
    <add key="ValidationSettings:UnobtrusiveValidationMode" value="None" />
  </appSettings>

  <system.web>
    <compilation debug="true" targetFramework="4.7.2" />
    <httpRuntime targetFramework="4.7.2" 
                 maxRequestLength="10240" 
                 executionTimeout="3600" 
                 enableVersionHeader="false" />
    
    <!-- Session güvenliği -->
    <sessionState mode="InProc" 
                  timeout="20" 
                  cookieName="TicketXSession" 
                  cookieSameSite="Strict" />

    <!-- Custom errors (production'da On yapın) -->
    <customErrors mode="RemoteOnly" defaultRedirect="~/Error.aspx">
      <error statusCode="404" redirect="~/Error404.aspx" />
      <error statusCode="500" redirect="~/Error500.aspx" />
    </customErrors>

    <!-- HTTP Security Headers -->
    <httpCookies httpOnlyCookies="true" requireSSL="true" sameSite="Strict" />
    
    <!-- Trace'i production'da kapatın -->
    <trace enabled="false" localOnly="true" pageOutput="false" />
    
    <!-- Debugging (production'da false yapın) -->
    <compilation debug="true" targetFramework="4.7.2" />
    
    <!-- ViewState MAC kontrolü -->
    <pages enableViewStateMac="true" validateRequest="true" viewStateEncryptionMode="Always">
      <namespaces>
        <add namespace="System.Web.Optimization" />
      </namespaces>
    </pages>
  </system.web>

  <system.webServer>
    <!-- Security Headers -->
    <httpProtocol>
      <customHeaders>
        <!-- XSS koruması -->
        <add name="X-XSS-Protection" value="1; mode=block" />
        <!-- Clickjacking koruması -->
        <add name="X-Frame-Options" value="SAMEORIGIN" />
        <!-- MIME type sniffing koruması -->
        <add name="X-Content-Type-Options" value="nosniff" />
        <!-- Referrer policy -->
        <add name="Referrer-Policy" value="strict-origin-when-cross-origin" />
        <!-- Content Security Policy (gerektiğinde özelleştirin) -->
        <add name="Content-Security-Policy" value="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data:;" />
        <!-- Strict Transport Security (HTTPS zorunlu) -->
        <add name="Strict-Transport-Security" value="max-age=31536000; includeSubDomains" />
        <!-- Permissions Policy -->
        <add name="Permissions-Policy" value="geolocation=(), microphone=(), camera=()" />
      </customHeaders>
    </httpProtocol>

    <!-- URL Rewrite ile HTTP -> HTTPS yönlendirme (IIS'de URL Rewrite modülü gerekli) -->
    <!--
    <rewrite>
      <rules>
        <rule name="HTTPS Redirect" stopProcessing="true">
          <match url="(.*)" />
          <conditions>
            <add input="{HTTPS}" pattern="^OFF$" />
          </conditions>
          <action type="Redirect" url="https://{HTTP_HOST}/{R:1}" redirectType="Permanent" />
        </rule>
      </rules>
    </rewrite>
    -->

    <!-- Hata sayfaları -->
    <httpErrors errorMode="DetailedLocalOnly">
      <remove statusCode="404" />
      <error statusCode="404" path="/Error404.aspx" responseMode="ExecuteURL" />
      <remove statusCode="500" />
      <error statusCode="500" path="/Error500.aspx" responseMode="ExecuteURL" />
    </httpErrors>

    <!-- Static content caching -->
    <staticContent>
      <clientCache cacheControlMode="UseMaxAge" cacheControlMaxAge="7.00:00:00" />
    </staticContent>

    <!-- Remove unnecessary HTTP headers -->
    <security>
      <requestFiltering removeServerHeader="true">
        <!-- Maksimum upload boyutu (10 MB) -->
        <requestLimits maxAllowedContentLength="10485760" />
      </requestFiltering>
    </security>
  </system.webServer>

  <system.codedom>
    <compilers>
      <compiler language="c#;cs;csharp" extension=".cs" type="Microsoft.CodeDom.Providers.DotNetCompilerPlatform.CSharpCodeProvider, Microsoft.CodeDom.Providers.DotNetCompilerPlatform, Version=2.0.1.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" warningLevel="4" compilerOptions="/langversion:default /nowarn:1659;1699;1701" />
      <compiler language="vb;vbs;visualbasic;vbscript" extension=".vb" type="Microsoft.CodeDom.Providers.DotNetCompilerPlatform.VBCodeProvider, Microsoft.CodeDom.Providers.DotNetCompilerPlatform, Version=2.0.1.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" warningLevel="4" compilerOptions="/langversion:default /nowarn:41008 /define:_MYTYPE=\&quot;Web\&quot; /optionInfer+" />
    </compilers>
  </system.codedom>

  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <!-- Assembly bindings buraya eklenebilir -->
    </assemblyBinding>
  </runtime>
</configuration>
